{"ast":null,"code":"var _jsxFileName = \"D:\\\\Libr\\\\front\\\\src\\\\Page\\\\SystemInfo.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport TableSheme from '../Components/TableSheme';\nimport Menu from '../Components/Menu';\nimport '../css/Table.css';\nimport { useParams } from 'react-router-dom';\nimport { useHttp } from '../hooks/http.hook';\nimport { useMessage } from '../hooks/message.hook';\n\nfunction SystemInfo() {\n  const [items, setItems] = useState([]);\n  const [isLoaded, setIsLoaded] = useState(false); // Нужно будет создать компонент и туда перенести добавление файла\n\n  const [selectedFile, setselectedFile] = useState(null);\n  const message = useMessage();\n  const {\n    request,\n    error,\n    clearError\n  } = useHttp();\n  const {\n    id\n  } = useParams();\n  const url = `http://localhost:5000/api/uploads/${id}`;\n  useEffect(() => {\n    message(error);\n    clearError();\n  }, [error, message, clearError]);\n  useEffect(async () => {\n    try {\n      const data = await request(url, 'GET');\n      setIsLoaded(true);\n      setItems(data);\n    } catch (error) {\n      setIsLoaded(true);\n    }\n  }, [isLoaded]); //перенести потом\n\n  const onChangeHandler = event => {\n    setselectedFile(event.target.files[0]);\n  };\n\n  const onClickHandler = () => {\n    const data = new FormData();\n    data.append('file', selectedFile, selectedFile.name);\n    axios.post(url, data);\n  };\n\n  const dowlandScheme = (_id, name) => {\n    axios({\n      url: `http://127.0.0.1:5000/api/uploads/schema/${_id}`,\n      method: 'GET',\n      responseType: 'blob' // important\n\n    }).then(response => {\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', name);\n      document.body.appendChild(link);\n      link.click();\n    });\n  };\n\n  const removeScheme = (_id, name) => {\n    axios.delete(`http://127.0.0.1:5000/api/uploads/schema/${_id}`, name);\n  };\n\n  if (error) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 16\n      }\n    }, \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \", error.message);\n  } else if (!isLoaded) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 16\n      }\n    }, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\");\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"system__btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      name: \"file\",\n      onChange: onChangeHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      class: \"btn btn-success btn-block\",\n      onClick: onClickHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 21\n      }\n    }, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C\")), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table__system\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      className: \"title__head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"table__tetx\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 33\n      }\n    }, \" \\u041D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0444\\u0430\\u0439\\u043B\\u0430 \")), /*#__PURE__*/React.createElement(\"th\", {\n      className: \"title__head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"table__tetx\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 33\n      }\n    }, \"\\u0420\\u0430\\u0437\\u043C\\u0435\\u0440\")), /*#__PURE__*/React.createElement(\"th\", {\n      className: \"title__head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"table__tetx\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 33\n      }\n    }, \"\\u0414\\u0430\\u0442\\u0430 \\u0438\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u044F\")), /*#__PURE__*/React.createElement(\"th\", {\n      className: \"title__head\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"table__tetx\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 33\n      }\n    }, \"\\u0412\\u0438\\u0434\\u0436\\u0435\\u0442\\u044B\")))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, items.map(obj => {\n      return /*#__PURE__*/React.createElement(TableSheme, Object.assign({\n        key: obj._id\n      }, obj, {\n        addScheme: dowlandScheme,\n        deleteScheme: removeScheme,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 37\n        }\n      }));\n    }))));\n  }\n}\n\nexport default SystemInfo;","map":{"version":3,"sources":["D:/Libr/front/src/Page/SystemInfo.jsx"],"names":["React","useState","useEffect","axios","TableSheme","Menu","useParams","useHttp","useMessage","SystemInfo","items","setItems","isLoaded","setIsLoaded","selectedFile","setselectedFile","message","request","error","clearError","id","url","data","onChangeHandler","event","target","files","onClickHandler","FormData","append","name","post","dowlandScheme","_id","method","responseType","then","response","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","removeScheme","delete","map","obj"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport axios from 'axios';\r\nimport TableSheme from '../Components/TableSheme'\r\nimport Menu from '../Components/Menu'\r\nimport '../css/Table.css'\r\nimport { useParams } from 'react-router-dom'\r\nimport { useHttp } from '../hooks/http.hook'\r\nimport { useMessage } from '../hooks/message.hook'\r\n\r\n\r\n\r\nfunction SystemInfo() {\r\n\r\n    const [items, setItems] = useState([]);\r\n    const [isLoaded, setIsLoaded] = useState(false);\r\n\r\n    // Нужно будет создать компонент и туда перенести добавление файла\r\n\r\n    const [selectedFile, setselectedFile] = useState(null)\r\n\r\n\r\n    const message = useMessage()\r\n    const { request, error, clearError } = useHttp()\r\n\r\n    const { id } = useParams()\r\n    const url = `http://localhost:5000/api/uploads/${id}`\r\n\r\n    useEffect(() => {\r\n        message(error)\r\n        clearError()\r\n    }, [error, message, clearError])\r\n\r\n\r\n    useEffect(async () => {\r\n        try {\r\n            const data = await request(url, 'GET')\r\n            setIsLoaded(true);\r\n            setItems(data);\r\n        } catch (error) {\r\n            setIsLoaded(true);\r\n        }\r\n    }, [isLoaded])\r\n\r\n\r\n    //перенести потом\r\n    const onChangeHandler = event => {\r\n        setselectedFile(event.target.files[0])\r\n    }\r\n\r\n    const onClickHandler = () => {\r\n        const data = new FormData()\r\n        data.append('file', selectedFile, selectedFile.name)\r\n        axios.post(url, data);\r\n    }\r\n\r\n    const dowlandScheme = (_id, name) => {\r\n        axios({\r\n            url: `http://127.0.0.1:5000/api/uploads/schema/${_id}`,\r\n            method: 'GET',\r\n            responseType: 'blob', // important\r\n        }).then((response) => {\r\n            const url = window.URL.createObjectURL(new Blob([response.data]));\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', name);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n        });\r\n    }\r\n\r\n    const removeScheme = (_id, name) => {\r\n        axios.delete(`http://127.0.0.1:5000/api/uploads/schema/${_id}`, name);\r\n    }\r\n\r\n\r\n    if (error) {\r\n        return <div>Ошибка: {error.message}</div>;\r\n    } else if (!isLoaded) {\r\n        return <div>Загрузка...</div>;\r\n    } else {\r\n        return (\r\n            <div>\r\n\r\n                <div className=\"system__btn\">\r\n                    <input type=\"file\" name=\"file\" onChange={onChangeHandler} />\r\n                    <button type=\"button\" class=\"btn btn-success btn-block\" onClick={onClickHandler}>Загрузить</button>\r\n\r\n                </div>\r\n\r\n                < table className=\"table__system\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th className=\"title__head\">\r\n                                <span className=\"table__tetx\"> Наименование файла </span>\r\n                            </th>\r\n                            <th className=\"title__head\">\r\n                                <span className=\"table__tetx\">Размер</span>\r\n                            </th>\r\n                            <th className=\"title__head\">\r\n                                <span className=\"table__tetx\">Дата изменения</span>\r\n                            </th>\r\n                            <th className=\"title__head\">\r\n                                <span className=\"table__tetx\">Виджеты</span>\r\n                            </th>\r\n                        </ tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {\r\n                            items.map((obj) => {\r\n                                return (\r\n                                    <TableSheme key={obj._id} {...obj}\r\n                                        addScheme={dowlandScheme}\r\n                                        deleteScheme={removeScheme}\r\n                                    />\r\n                                )\r\n                            })\r\n                        }\r\n                    </ tbody>\r\n                </ table>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SystemInfo\r\n"]},"metadata":{},"sourceType":"module"}